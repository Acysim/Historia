(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f64a775"],{2316:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("14d9"),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),_utils_help__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("163b"),_utils_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("79fa"),_views_app_app_menu_vue__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("5098"),vuex__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("2f62"),_api_app__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("b562"),_utils_EventBus__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("4a9d");__webpack_exports__["a"]={components:{appMenu:_views_app_app_menu_vue__WEBPACK_IMPORTED_MODULE_3__["a"],Loading:()=>__webpack_require__.e("chunk-13271ee2").then(__webpack_require__.bind(null,"3a5e"))},beforeRouteUpdate(e,t,a){"work-bench"===e.name||"approval-center"===e.name||"handling-guideline"===e.name||void 0===e.name?this.showNavBar=!1:this.showNavBar=!0,a()},props:{appId:String,pageId:String,pageName:String},provide(){return{appInfo:this.appInfo}},data(){return{appName:"",showNavBar:!1,loaded:!1,appInfo:{},show:!1,menus:[],type:null}},computed:{...Object(vuex__WEBPACK_IMPORTED_MODULE_4__["c"])(["userInfo"]),iframeURL(){return this.$route.query.iframeURL},openFirstMenuOfMobile(){var e,t,a;return null!=(null===(e=this.appInfo.extension)||void 0===e?void 0:e.ext3)&&(!(null===(t=this.appInfo.extension)||void 0===t||!t.ext3.includes("{"))&&JSON.parse(null===(a=this.appInfo.extension)||void 0===a?void 0:a.ext3).openFirstMenuOfMobile)},goHomeBarVisible(){return"work-bench"!==this.$route.name&&!0!==projectConfig.hideBackToAppHomeBtn&&"true"!==this.$route.query.hideBackToAppHomeBtn},enableHttpLoading(){var e;return null===(e=projectConfig.enableHttpLoading)||void 0===e||e},mobileFormNavBarBgColor(){var e;if(null===(e=this.appInfo.extension)||void 0===e||!e.ext3)return"#fff";try{var t;const e=JSON.parse(null===(t=this.appInfo.extension)||void 0===t?void 0:t.ext3);return e.mobileFormNavBarBgColor?e.mobileFormNavBarBgColor:"#fff"}catch(a){return"#fff"}}},created(){"work-bench"===this.$route.name||"approval-center"===this.$route.name||"handling-guideline"===this.$route.name||void 0===this.$route.name?this.showNavBar=!1:this.showNavBar=!0,this.getMenus(),Object(_utils_help__WEBPACK_IMPORTED_MODULE_1__["t"])(),Object(_utils_i18n__WEBPACK_IMPORTED_MODULE_2__["f"])(this.appId,_utils_i18n__WEBPACK_IMPORTED_MODULE_2__["d"].application)},destroyed(){_utils_EventBus__WEBPACK_IMPORTED_MODULE_6__["a"].$emit("endApp"),_utils_EventBus__WEBPACK_IMPORTED_MODULE_6__["a"]._events.endApp=[],_utils_EventBus__WEBPACK_IMPORTED_MODULE_6__["a"]._events.startApp=[]},methods:{initAppEvent(){var _this$appInfo$extensi6;const code=null===(_this$appInfo$extensi6=this.appInfo.extension)||void 0===_this$appInfo$extensi6?void 0:_this$appInfo$extensi6.appEvent;code&&(eval(code),_utils_EventBus__WEBPACK_IMPORTED_MODULE_6__["a"].$emit("startApp",this.appInfo))},onGoHome(){this.$router.replace({name:"work-bench"})},backToWorkBench(){"list"!=this.type&&this.$router.replace({name:"work-bench"})},getMenus(){const{RoleIds:e,UserAccount:t}=this.userInfo,a=[/^\/app\/((?:[^\\/]+?))(?:\/(?=$))?$/i,/^\/app\/((?:[^\\/]+?))\/home(?:\/(?=$))?$/i,/^\/app\/((?:[^\\/]+?))\/home\/workBench(?:\/(?=$))?$/i,/^\/app\/((?:[^\\/]+?))\/((?:[^\\/]+?))(?:\/(?=$))?$/i];_api_app__WEBPACK_IMPORTED_MODULE_5__["a"].getUserAppViewAndMenu(e,this.appId,t).then(({code:e,data:t,message:n})=>{if(1===e){this.menus=t.menus.filter(e=>e.url&&e.url.includes("iTree")?void 0:e)||[],Object.assign(this.appInfo,t);try{var i;this.type=JSON.parse(null===(i=this.appInfo.extension)||void 0===i?void 0:i.ext3).mobile}catch(_){this.type="group"}if(Object(_utils_help__WEBPACK_IMPORTED_MODULE_1__["q"])(t.displayNameForApp||t.displayName),this.initAppEvent(),this.loaded=!0,this.$route.query.stopPageJump)return void this.$router.replace({name:"wei-home"});!this.pageId&&this.openFirstMenuOfMobile?this.toDefaultPage():a.some(e=>e.test(this.$route.path))&&"work-bench"!==this.$route.name&&this.$router.replace({name:"wei-home"})}else this.loaded=!0,this.$notify({message:n,type:"danger"})})},redirtPage({id:e,url:t,name:a,openType:n}){if("string"!==typeof t)return;this.show=!1;const{appId:i}=this,_=`/app/${i}/${e}/${encodeURIComponent(a)}`;t.includes("http")?2==n?this.$router.push(_+"/iframe?iframeURL="+t):open(t):this.$router.push(_+t),Object(_utils_help__WEBPACK_IMPORTED_MODULE_1__["q"])(this.appName)},toDefaultPage(){const e=this.menus.find(e=>{const t=e.displayType;return null===t||Array.isArray(t)&&t.includes("mobile")?e:void 0});this.redirtPage(e)}}}},"33b6":function(e,t,a){},5098:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"menu"},[e._l(e.menus,(function(t,n){return[a("div",{key:n,class:["menu-item",{"has-submenu":e.hasSubMenu(t)}],on:{click:function(a){return a.stopPropagation(),e.menuClick(t)}}},[a("i",{class:[e.icon(t)]}),a("span",{staticClass:"menu-name"},[e._v(" "+e._s(e.$t(t.name))+" ")]),e.hasSubMenu(t)?a("app-menu",{attrs:{"item-click":e.itemClick,menus:t.subMenus}}):e._e()],1)]}))],2)},i=[],_={name:"app-menu",components:{},props:{menus:{type:Array,default:()=>[]},itemClick:{type:Function}},data(){return{}},computed:{},methods:{menuClick(e){this.itemClick(e)},icon(e){return this.hasSubMenu(e)?"fa fa-fw fa-folder-o":"fa fa-fw fa-circle-o"},hasSubMenu(e){return e.subMenus&&e.subMenus.length>0}}},s=_,o=(a("b821"),a("2877")),r=Object(o["a"])(s,n,i,!1,null,"45a9aba4",null);t["a"]=r.exports},"5f18":function(e,t,a){"use strict";a("33b6")},"71dc":function(e,t,a){},b821:function(e,t,a){"use strict";a("71dc")},cb99:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.loaded?a("div",{staticClass:"app-home"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.goHomeBarVisible,expression:"goHomeBarVisible"}],staticClass:"go-home-fixed-toolbar",on:{click:function(t){return t.stopPropagation(),e.onGoHome.apply(null,arguments)}}},[a("van-icon",{staticStyle:{"line-height":"20px"},attrs:{name:"wap-home-o",size:"25"}})],1),"list"==this.type?[a("van-popup",{style:{width:"60%",height:"100%"},attrs:{position:"left"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("van-nav-bar",{attrs:{title:e.$t(e.appName),border:"",fixed:"",placeholder:""}}),a("app-menu",{attrs:{menus:e.menus,"item-click":e.redirtPage}})],1),a("van-nav-bar",{attrs:{title:e.$t(e.pageName),fixed:"",placeholder:"",border:""},on:{"click-left":function(t){e.show=!0}},scopedSlots:e._u([{key:"left",fn:function(){return[a("van-icon",{attrs:{name:"wap-nav"}}),a("span",{staticClass:"nav-bar-text-left"},[e._v(e._s(e.$t("功能菜单")))])]},proxy:!0}],null,!1,2559168120)})]:"list"!==this.type&&e.showNavBar?a("van-nav-bar",{directives:[{name:"hide-on-dingtalk",rawName:"v-hide-on-dingtalk"}],staticClass:"app-home__nav-bar",style:{"--nav-bg-color":e.mobileFormNavBarBgColor},attrs:{title:e.$t(e.pageName||e.appInfo.name),fixed:"",placeholder:"",border:"","left-text":e.$t("返回"),"left-arrow":""},on:{"click-left":e.backToWorkBench}}):e._e(),e.iframeURL?a("iframe",{staticClass:"iframe",staticStyle:{height:"calc(100vh - 106px)",display:"block"},attrs:{src:e.iframeURL}}):[e.loaded?a("router-view",{key:e.pageId,attrs:{appInfo:e.appInfo}}):e._e()]],2):a("div",[e.enableHttpLoading?a("Loading",{attrs:{height:"100vh"}}):e._e()],1)},i=[],_=a("2316"),s=_["a"],o=(a("5f18"),a("2877")),r=Object(o["a"])(s,n,i,!1,null,null,null);t["default"]=r.exports}}]);